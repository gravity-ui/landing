{
    "id": 73,
    "name": "blog/md-editor-in-gravity-ui",
    "createdAt": "2026-01-15T12:37:10.557Z",
    "updatedAt": "2026-01-15T12:37:10.557Z",
    "type": "default",
    "isDeleted": false,
    "versionOnTranslationId": null,
    "searchCategorySlug": "blog",
    "regions": [],
    "pageId": 73,
    "regionCode": "en",
    "publishedVersionId": 212,
    "lastVersionId": 212,
    "content": "blocks:\n  - type: blog-header-block\n    resetPaddings: true\n    paddingBottom: l\n    width: m\n    verticalOffset: m\n    theme: dark\n    background:\n      image:\n        src: >-\n          https://storage.yandexcloud.net/gravity-landing-static/blog/blog-cover-bg.png\n        disableCompress: true\n      color: '#2A1A2A'\n      fullWidth: false\n  - type: blog-layout-block\n    resetPaddings: true\n    mobileOrder: reverse\n    children:\n      - type: blog-yfm-block\n        resetPaddings: true\n        column: right\n        text: >\n\n          ![image](https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/speaker.jpg\n          =80x)\n\n\n          **谢尔盖·马赫纳特金**\n\n          界面开发者\n      - type: blog-yfm-block\n        column: right\n        resetPaddings: true\n        text: \"\\n本文内容：\\n\\n  - [为什么我们需要自己的 Markdown Editor](#why)\\n  - [Gravity\\_UI 中 Markdown Editor 的能力](#capabilities)\\n  - [架构](#architecture)\\n  - [集成](#integration)\\n  - [自定义扩展的集成](#extensions)\\n\"\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic1.png\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: \"\\n{% cut \\\"TL;DR\\\" %}\\n\\n* 支持同时在 [WYSIWYG](https://ru.wikipedia.org/wiki/WYSIWYG){target=\\\"_blank\\\"} 模式与 [markdown](https://en.wikipedia.org/wiki/Markdown){target=\\\"_blank\\\"} 标记模式下工作（带预览与分屏）。\\n* 开箱即用支持大量区块（blocks）。\\n* 可扩展功能——WYSIWYG 模式下有扩展系统（extension system）。\\n* 为 React 应用场景而设计。\\n* 使用来自 [Gravity\\_UI](https://gravity-ui.com/){target=\\\"_blank\\\"} 的主题化与组件。\\n* 完全基于开源技术构建（[ProseMirror](https://prosemirror.net/){target=\\\"_blank\\\"}、[CodeMirror](https://codemirror.net/){target=\\\"_blank\\\"}、[markdown‑it](https://github.com/markdown-it/markdown-it){target=\\\"_blank\\\"}、[Diplodoc](https://diplodoc.com/){target=\\\"_blank\\\"}、[Gravity\\_UI](https://gravity-ui.com/){target=\\\"_blank\\\"}）。\\n* 符合 [CommonMark](https://spec.commonmark.org/){target=\\\"_blank\\\"} 标准，支持标准 markdown 语言以及 [Yandex Flavored Markdown (YFM)](https://diplodoc.com/docs/ru/index-yfm){target=\\\"_blank\\\"}。\\n\\n{% endcut %}\\n\\n你好！我叫谢尔盖·马赫纳特金，在 Yandex\\_Cloud 的 User Experience 部门担任开发者。去年我们曾撰文介绍过我们的[设计系统与组件库 Gravity\\_UI](https://habr.com/ru/companies/yandex/articles/773870/){target=\\\"_blank\\\"}。从那之后，该系统多次更新并新增了许多功能。今天我想介绍一个新工具——Markdown Editor，它能显著简化文档编写与维护的流程。\\n\\n我们将聊聊该用户界面的诞生背景、架构特性，以及集成与自定义扩展开发的技术细节，最后再解释为什么这一切都以开源形式提供。\\n\\n顺便说一句，你可以在这里试用该工具：\\n\\n  * [Demo](https://gravity-ui.com/libraries/markdown-editor/playground){target=\\\"_blank\\\"}          \\n  * [GitHub](https://github.com/gravity-ui/markdown-editor/){target=\\\"_blank\\\"}      \\n  * [Storybook](https://preview.gravity-ui.com/md-editor/){target=\\\"_blank\\\"}\\n\"\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          ## 为什么我们需要自己的 Markdown Editor{#why}\n\n\n          为了方便存储与结构化企业信息，\n          我们开发了\n          [Wiki](https://wiki.yandex.ru/){target=\"_blank\"} 平台，用来\n          创建知识库。除了知识库之外，我们也在推进诸如\n          Docs as Code 这样的文档实践：文档与代码在文件存储中\n          并排共存（.md 文件）。由此诞生了平台\n          [Diplodoс](https://diplodoc.com/){target=\"_blank\"}。\n\n\n          Wiki 与 Diplodoc 的共同点在于，两者都使用一种 markdown 方言——\n          Yandex Flavored Markdown (YFM)。该方言也被用于\n          Nebius、Bitrix、DoubleCloud、Mappable、Meteum。\n\n\n          随着时间推移，我们发现有两类用户对写作与编辑的过程\n          有着不同的理解。一类用户希望在编辑文本时立即看到最终结果，\n          就像 MS Word、Confluence 或 Notion 那样。另一类用户只信任标记语言，\n          更倾向于用 markdown 来排版页面。我们没有找到能同时支持\n          WYSIWYG/markdown 双模式的知名库。例如 Notion 只有 WYSIWYG，\n          而代码编辑器通常只有 markdown 与预览模式。\n\n\n          因此我们开发了一个 markdown 编辑器，它能够同时在两种模式下工作：\n          可视化（WYSIWYG）与标记（markdown）。在第一种模式中，工具栏的图标\n          帮助用户为文本添加格式；在第二种模式中，用户可以手动编辑\n          markdown 代码。此外，我们的方案会将文档保存为 md 文件，\n          不管创建时使用的是哪种模式。\n\n\n          下面是可视化编辑器的样子：可以通过按钮对文本进行格式化：\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic2.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          而下面是标记模式：格式化元素通过特殊符号来表示：\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic3.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: \"\\n## Gravity\\_UI 中 Markdown Editor 的能力{#capabilities}\\n\\n编辑器符合 CommonMark 标准，支持标准 markdown 与 YFM。我们还加入了把语法扩展到其他 markdown 方言的能力，例如 GitHub Flavored Markdown。同时，编辑器允许从标记模式切换到 WYSIWYG 模式，而文档将以 md 标记或扩展 md（例如使用 YFM 时）形式存储。\\n\\n### 扩展\\n\\n编辑器内置了很多扩展与配置。例如 Mermaid 图表与 HTML 区块：\\n\"\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic4.png\n        fullscreen: true\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic5.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          我们努力让编辑器的内核易于扩展。开发者可以创建自己的扩展或附加功能，用来：\n\n            * 添加新实体——区块（block）或文本修饰符（mark）；\n            * 进一步配置 markdown 解析器；\n            * 添加 actions，以便从外部与编辑器交互；\n            * 丰富界面能力，例如输入斜杠时显示可用命令菜单；\n            * 修改现有行为，例如插入图片与文件，并把它们上传到存储。\n\n          下面是我们为 Wiki 开发的一些扩展示例：\n\n            * 协作编辑模式；\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic6.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: |\n\n          * [draw.io](http://draw.io/){target=\"_blank\"} 图表区块；\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic7.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: |\n\n          * [YandexGPT](https://ya.ru/ai/gpt-3){target=\"_blank\"} 插件；\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic8.png\n        fullscreen: true\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic9.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: |\n\n          * includes（包含）；\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic10.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: |\n\n          * 章节结构；\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic11.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: |\n\n          * 用于创建便捷网格的分区；\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic12.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: |\n\n          * 带预览的 markdown 模式；\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic13.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: |\n\n          * 以及更多。\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic14.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          标记可以自动转换。如果你更喜欢不使用鼠标，在可视化编辑器模式中\n          也提供了特殊符号，允许直接在文本中应用标记。\n          例如，`**` 会在 WYSIWYG 模式下将文本切换为粗体。\n          借助这些符号，可以对文本进行格式化，创建行内代码与代码块。\n\n\n          也可以输入 `/` 来唤起扩展菜单。\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        paddingBottom: s\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic15.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          ### 预设\n\n\n          编辑器允许为每个项目单独配置工具栏，但也提供了一些现成的配置——预设（presets）。\n\n\n          不使用预设的编辑器：\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic16.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          [CommonMark\n          预设](https://preview.gravity-ui.com/md-editor/?path=/story/markdown-editor-presets--common-mark){target=\"_blank\"}\n          支持标准 markdown 元素：粗体、斜体、标题、列表、链接、引用、代码块。\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic17.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          在\n          [默认预设](https://preview.gravity-ui.com/md-editor/?path=/story/markdown-editor-presets--default){target=\"_blank\"}\n          中，还会出现删除线文本，以及一个单元格只能包含纯文本的表格。\n          该预设对应标准 markdown-it。\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic18.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          如上所述，编辑器也支持 YFM，因此可以与 Diplodoc 很好地集成。\n          在\n          [YFM 预设](https://preview.gravity-ui.com/md-editor/?path=/story/markdown-editor-presets--yfm){target=\"_blank\"}\n          中会出现额外元素：增强表格、插入文件与图片、复选框、cut、tabs、等宽字体。\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic19.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          [完整预设](https://preview.gravity-ui.com/md-editor/?path=/story/markdown-editor-presets--full){target=\"_blank\"}\n          包含更多元素。\n      - type: blog-media-block\n        column: left\n        resetPaddings: true\n        text: ''\n        image:\n          src: >-\n            https://storage.yandexcloud.net/gravity-landing-static/blog/md-editor-in-gravity-ui/pic20.png\n        fullscreen: true\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          ## 架构{#architecture}\n\n\n          编辑器在 WYSIWYG 模式下的核心基于知名库\n          [ProseMirror](http://prosemirror.net/){target=\"_blank\"}；\n          在标记模式下使用\n          [CodeMirror](https://codemirror.net/){target=\"_blank\"}。\n          ProseMirror 支持带格式的编辑，而 CodeMirror 适用于需要处理\n          未标记文本的场景。\n\n\n          我们选择这些库，是因为它们由同一位作者开发，在架构与实现方式上保持一致，\n          有庞大社区支持，被许多编辑器采用，并且针对文本处理做了良好优化。\n          例如：用于对文档应用变更的事务（transaction）系统、用于 view 的装饰（decoration）、\n          DOM 虚拟化，以及对多种编程语言语法的支持。\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: >\n\n          ## 集成{#integration}\n\n\n          我们的编辑器可以很容易地以 [React hook](https://github.com/gravity-ui/markdown-editor/blob/main/docs/how-to-add-editor-with-create-react-app.md){target=\"_blank\"} 的形式接入：\n\n\n          ```javascript\n\n\n          import React from 'react';\n\n          import {useMarkdownEditor, MarkdownEditorView} from\n          '@gravity-ui/markdown-editor';\n\n          import {toaster} from '@gravity-ui/uikit/toaster-singleton-react-18';\n\n\n          function Editor({onSubmit}) {\n            const editor = useMarkdownEditor({allowHTML: false});\n\n            React.useEffect(() => {\n              function submitHandler() {\n                // Serialize current content to markdown markup\n                const value = editor.getValue();\n                onSubmit(value);\n              }\n\n              editor.on('submit', submitHandler);\n              return () => {\n                editor.off('submit', submitHandler);\n              };\n            }, [onSubmit]);\n\n            return <MarkdownEditorView stickyToolbar autofocus toaster={toaster} editor={editor} />;\n          }\n\n          ```\n\n          我们使用 GravityUI 的 uikit 组件库。\n          这能保证整个界面保持一致，并符合统一的样式规范。\n          使用这些组件也能为用户提供高一致性与可识别性，从而让编辑体验更顺畅。\n\n\n          我们提供了详细\n          [说明文档](https://github.com/gravity-ui/markdown-editor/blob/main/README.md#getting-started){target=\"_blank\"}\n          介绍如何在 React 应用中接入编辑器，以及如何接入各种扩展：例如\n          [YandexGPT](https://github.com/gravity-ui/markdown-editor/blob/main/docs/how-to-connect-gpt-extensions.md){target=\"_blank\"}、\n          [Mermaid](https://github.com/gravity-ui/markdown-editor/blob/main/docs/how-to-connect-mermaid-extension.md){target=\"_blank\"}\n          或\n          [LaTeX](https://github.com/gravity-ui/markdown-editor/blob/main/docs/how-to-connect-latex-extension.md){target=\"_blank\"}。\n      - type: blog-yfm-block\n        column: left\n        resetPaddings: true\n        text: \"\\n## 自定义扩展的集成{#extensions}\\n\\n编辑器已经集成了一些额外扩展。但如果这还不够，开发者可以向编辑器的 WYSIWYG 模式添加自己的扩展。扩展能带来什么，我们在上文已讨论过。\\n\\n如果你想添加新的区块或文本修饰符，首先需要通过 configureMd 方法配置内部的 markdown-it 实例。然后用 addNode 或 addMark 方法把新实体注册进去：传入实体名称，以及一个回调函数，该回调返回一个包含三个必填字段的对象：\\n\\n```javascript\\nimport insPlugin from 'markdown-it-ins';\\nexport const underlineMarkName = 'ins';\\n\\nexport const UnderlineSpecs: ExtensionAuto = (builder) => {\\n    builder\\n        .configureMd((md) => md.use(insPlugin))\\n        .addMark(underlineMarkName, () => ({\\n            spec: {\\n                parseDOM: [{tag: 'ins'}, {tag: 'u'}],\\n                toDOM() {\\n                    return ['ins'];\\n                },\\n            },\\n            toMd: {open: '++', close: '++', mixable: true, expelEnclosingWhitespace: true},\\n            fromMd: {tokenSpec: {name: underlineMarkName, type: 'mark'}},\\n        }));\\n};\\n```\\n\\n  * `spec` — ProseMirror 的规范（specification）；\\n  * `fromMd` — 将 markdown 标记解析为 ProseMirror 内部表示的配置；\\n  * `toMd` — 将该实体序列化为 markdown 标记的配置。\\n\\n例如，下方是下划线文本扩展的配置。它还可以通过 `addAction` 方法添加 action 来进一步扩展：\\n\\n```javascript\\nimport {toggleMark} from 'prosemirror-commands';\\n\\nconst undAction = 'underline';\\n\\nbuilder\\n    .addAction(undAction, ({schema}) => ({\\n        isActive: (state) => Boolean(isMarkActive(state, markType)),\\n        isEnable: toggleMark(underlineType(schema)),\\n        run: toggleMark(underlineType(schema)),\\n      })\\n  )\\n```\\n\\n该 action 可以在代码中这样调用：\\n\\n```javascript\\n// editor —— 调用 useMarkdownEditor 得到的编辑器实例\\neditor.actions.underline.run(),\\n```\\n\\n在[文档](https://github.com/gravity-ui/markdown-editor/blob/main/docs/how-to-create-extension.md){target=\\\"_blank\\\"}中可以查看创建新扩展的完整指南。\\n\\n---------------------\\n\\n我们持续拓展编辑器的使用边界：目前正在开发一个用于 [VS Code](https://code.visualstudio.com/){target=\\\"_blank\\\"} 的插件，让你可以直接在 VS Code 中以便捷的 WYSIWYG 模式编辑 md 文件。我们还计划加入完整的移动端模式，这将使用户只需一部手机也能在我们的编辑器中工作。\\n\\n我们的编辑器并非一蹴而就：它是经验与知识长期积累的结果。我们自豪的是，编辑器完全建立在开源产品之上，其中包括可靠且久经验证的 ProseMirror、CodeMirror、markdown-it，以及我们自己的开发成果——Diplodoc 与 Gravity\\_UI。\\n\\n你也可以随时为编辑器的发展做出贡献：[提交 Pull Request](https://github.com/gravity-ui/markdown-editor/pulls){target=\\\"_blank\\\"}，或者帮助解决 [Issues](https://github.com/gravity-ui/markdown-editor/issues){target=\\\"_blank\\\"} 中列出的现有问题。你的支持与新视角将帮助我们把编辑器做得更好。如果你觉得这个项目有用，也欢迎在我们的 [GitHub 仓库](https://github.com/gravity-ui/markdown-editor){target=\\\"_blank\\\"} 点个 Star，这对我们很重要 :)\\n\"\n  - type: blog-layout-block\n    resetPaddings: true\n    fullWidth: false\n    children:\n      - type: blog-meta-block\n        column: left\n        resetPaddings: true\n  - type: blog-suggest-block\n    resetPaddings: true\n",
    "title": "",
    "noIndex": false,
    "shareTitle": null,
    "shareDescription": null,
    "shareImage": null,
    "pageLocaleId": null,
    "author": "timofeyevvv",
    "metaDescription": null,
    "keywords": [],
    "shareGenTitle": null,
    "canonicalLink": null,
    "sharingType": "auto",
    "sharingTheme": "light",
    "comment": "initial",
    "shareImageUrl": "https://storage.cloud-preprod.yandex.net/ui-api-ru-preprod-stable-share-generator-screenshots/cache/6a79bcd295f4b97553c519c462935cc394f84cb8.png",
    "pageRegionId": 80,
    "summary": null,
    "versionId": 212,
    "service": null,
    "solution": null,
    "locales": [
      {
        "id": 79,
        "pageId": 73,
        "locale": "ru",
        "createdAt": "2026-01-15T12:31:20.911Z",
        "updatedAt": "2026-01-15T12:31:20.973Z",
        "publishedVersionId": null,
        "lastVersionId": 208
      },
      {
        "id": 80,
        "pageId": 73,
        "locale": "en",
        "createdAt": "2026-01-15T12:31:20.982Z",
        "updatedAt": "2026-01-15T12:31:21.040Z",
        "publishedVersionId": null,
        "lastVersionId": 209
      }
    ],
    "pageRegions": [
      {
        "regionCode": "ru-ru",
        "publishedVersionId": 210
      },
      {
        "regionCode": "en",
        "publishedVersionId": 212
      }
    ],
    "searchCategory": {
      "id": 7,
      "slug": "blog",
      "title": "Blog",
      "url": "/blog"
    },
    "voiceovers": []
  }
  