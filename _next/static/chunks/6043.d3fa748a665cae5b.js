(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6043],{66043:function(e,t,n){"use strict";n.r(t),n.d(t,{GraphPlayround:function(){return ea}});var r=n(85893),o=n(25180),i=n(62784),s=n(5233),c=n(67294),a=n(9643);n(86540);var l=n(3742),d=n(79951),h=n(21203),u=n(93060),g=n(39429),p=n(95550),m=n(44702),b=n(97346),k=n(83608),x=n.n(k),f=n(46369);n(27624);let C=(0,a.Ge)("block");function y(e){let{graph:t,block:n}=e;return(0,r.jsxs)(d.Je,{graph:t,block:n,className:C(),children:[n.anchors.map(e=>(0,r.jsx)(d.zg,{position:"absolute",graph:t,anchor:e},e.id)),(0,r.jsxs)(g.k,{grow:1,direction:"column",children:[(0,r.jsx)(m.x,{ellipsis:!0,variant:"caption-2",className:C("name"),children:n.name}),(0,r.jsx)(m.x,{ellipsis:!0,variant:"caption-1",color:"secondary",children:n.meta?.description})]}),(0,r.jsx)(g.k,{children:(0,r.jsx)(i.z,{onClick:e=>e.stopPropagation(),children:(0,r.jsx)(p.J,{data:f.Z})})})]})}function v(e){let t=18*e;return e>=1&&(t+=8*e),t+18}class j extends l.lR{renderHTML(){return(0,r.jsx)(y,{graph:this.context.graph,block:this.connectedState.$state.value})}getAnchorPosition(e){let t=this.getAnchorsYOffter(e.type),n=v(this.connectedState.$anchorIndexs.value?.get(e.id)||0);return{x:e.type===l.TX.OUT?this.state.width:0,y:t+n}}renderMinimalisticBlock(e){this.renderBody(e),.1>this.context.camera.getCameraScale()||(e.fillStyle="rgba(255, 190, 92, 1)",function(e,t,n){t.save();let r=new Path2D(e.path),o=e.width/e.iniatialWidth,i=e.height/e.initialHeight;t.translate(n.x+n.width/2-e.width/2,n.y+n.height/2-e.height/2),t.scale(o,i),t.fill(r,"evenodd"),t.restore()}({path:"M5.75 2.5H10.25C10.7842 2.5 11.2532 2.77929 11.519 3.19983C10.6259 3.58121 10 4.46751 10 5.5C10 6.61941 10.7357 7.56698 11.75 7.88555V12C11.75 12.8284 11.0784 13.5 10.25 13.5H5.75C5.21576 13.5 4.74676 13.2207 4.48102 12.8002C5.3741 12.4188 6 11.5325 6 10.5C6 9.38059 5.26428 8.43302 4.25 8.11445V7.88555C5.26428 7.56698 6 6.61941 6 5.5C6 4.46751 5.3741 3.58121 4.48102 3.19982C4.74676 2.77929 5.21576 2.5 5.75 2.5ZM2.75 8.11445V7.88555C1.73572 7.56698 1 6.61941 1 5.5C1 4.32762 1.80699 3.34373 2.8958 3.0735C3.28617 1.87008 4.41648 1 5.75 1H10.25C11.5835 1 12.7138 1.87008 13.1042 3.07351C14.193 3.34373 15 4.32762 15 5.5C15 6.61941 14.2643 7.56698 13.25 7.88555V12C13.25 13.6569 11.9069 15 10.25 15H5.75C4.41647 15 3.28616 14.1299 2.8958 12.9265C1.80699 12.6563 1 11.6724 1 10.5C1 9.38059 1.73572 8.43302 2.75 8.11445ZM3.5 11.5C4.05228 11.5 4.5 11.0523 4.5 10.5C4.5 9.94771 4.05228 9.5 3.5 9.5C2.94772 9.5 2.5 9.94772 2.5 10.5C2.5 11.0523 2.94772 11.5 3.5 11.5ZM2.5 5.5C2.5 4.94772 2.94772 4.5 3.5 4.5C4.05228 4.5 4.5 4.94772 4.5 5.5C4.5 6.05228 4.05228 6.5 3.5 6.5C2.94772 6.5 2.5 6.05229 2.5 5.5ZM12.5 4.5C11.9477 4.5 11.5 4.94772 11.5 5.5C11.5 6.05229 11.9477 6.5 12.5 6.5C13.0523 6.5 13.5 6.05229 13.5 5.5C13.5 4.94772 13.0523 4.5 12.5 4.5Z",width:56,height:56,iniatialWidth:14,initialHeight:14},e,this.getContentRect()))}renderSchematicView(e){this.renderBody(e),this.context.camera.getCameraScale()>this.context.constants.block.SCALES[0]&&(e.fillStyle=this.context.colors.block?.text||"",e.textAlign="center",this.renderTextAtCenter(this.state.name,e))}subscribe(e){return this.addEventListener("mouseenter",()=>{this.hovered=!0,this.performRender()}),this.addEventListener("mouseleave",()=>{this.hovered=!1,this.performRender()}),super.subscribe(e)}renderName(e){this.context.camera.getCameraScale()>this.context.constants.block.SCALES[0]&&(e.fillStyle=this.context.colors.block?.text||"",e.textAlign="center",this.renderText(this.state.name,e))}getAnchorsYOffter(e){let t=this.connectedState.$state.value.anchors.filter(t=>t.type===e),{height:n}=this.getContentRect();return(n-v(t.length-1))/2}renderTextAtCenter(e,t){let n=this.getContentRect(),r=this.context.camera.getCameraScale();t.fillStyle=this.context.colors.block?.text||"",t.textAlign="center",t.textBaseline="top";let{lines:o,measures:i}=(0,l.If)(e,t,n,{font:`500 ${9/r}px YS Text`,lineHeight:9/r}),s=n.height/2-i.height/2;for(let e=0;e<o.length;e++){let[n,r,i]=o[e],c=Math.floor(i+s);t.fillText(n,r,c)}}renderBody(e){let t=this.context.camera.getCameraScale();e.fillStyle=this.hovered?"rgba(57, 47, 57, 1)":this.context.colors.block?.background||"",e.beginPath(),e.roundRect(this.state.x,this.state.y,this.state.width,this.state.height,8),e.fill(),this.state.selected?(e.lineWidth=Math.min(Math.round(2/t),12),e.strokeStyle=this.context.colors.block?.selectedBorder||""):(e.lineWidth=Math.min(Math.round(1/t),12),e.strokeStyle=this.hovered?"rgba(229, 229, 229, 0.4)":this.context.colors.block?.border||""),e.stroke(),e.closePath()}constructor(...e){super(...e),this.cursor="pointer",this.hovered=!1}}var S=n(15457),B=n(63764),w=n(66375);n(78407);let N="gravity";function I(e,t){let n=e.getValue(),r=`"id": "${String(t)}"`,o=n.indexOf(r),i=n.lastIndexOf("{",o),s=n.indexOf("}",o),c=1,a=s+1;for(;c>0&&a<n.length;)"{"===n[a]?c++:"}"===n[a]&&c--,a++;return s=a,{start:e.getPositionAt(i),end:e.getPositionAt(s)}}B._m.init().then(e=>{!function(e){e.editor.defineTheme(N,{base:"vs-dark",inherit:!0,rules:[{token:"string.key.json",foreground:"#febe5c"}],colors:{"editor.foreground":"#ffdb4d4d","editor.background":"#251b25","editor.lineHighlightBackground":"#ffdb4d4d","editorLineNumber.foreground":"#bd5c0a","editor.selectionBackground":"#ffdb4d4d","editor.inactiveSelectionBackground":"#ffdb4d4d"}})}(e),function(e){e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemaValidation:"error",schemas:[{uri:"http://gravity/graph-playground/schema.json",fileMatch:["*"],schema:{type:"object",properties:{blocks:{type:"array",items:{$ref:"#/definitions/TBlock"},description:"List of blocks (TBlock[])"},connections:{type:"array",items:{$ref:"#/definitions/TConnection"},description:"List of connections (TConnection[])"}},required:["blocks","connections"],definitions:{TBlock:{type:"object",properties:{id:{type:"string",description:"Block identifier (TBlockId)"},is:{type:"string",description:"String representation of the block type"},x:{type:"number",description:"X coordinate"},y:{type:"number",description:"Y coordinate"},width:{type:"number",description:"Block width"},height:{type:"number",description:"Block height"},selected:{type:"boolean",description:"Flag indicating if the block is selected"},name:{type:"string",description:"Block name"},anchors:{type:"array",items:{$ref:"#/definitions/TAnchor"},description:"List of anchors (TAnchor[])"},meta:{type:"object",description:"Meta information (optional)"}},required:["id","is","x","y","width","height","selected","name","anchors"]},TConnection:{type:"object",properties:{sourceBlockId:{type:"string",description:"Identifier of the source block"},targetBlockId:{type:"string",description:"Identifier of the target block"},sourceAnchorId:{type:"string",description:"Identifier of the source anchor (optional)"},targetAnchorId:{type:"string",description:"Identifier of the target anchor (optional)"},label:{type:"string",description:"Connection label (optional)"},styles:{type:"object",properties:{dashes:{type:"array",items:{type:"number"},description:"Array of dash lengths for dashed lines (optional)"}},additionalProperties:!0,description:"Connection styles (optional)"},dashed:{type:"boolean",description:"Flag indicating if the line is dashed (optional)"},selected:{type:"boolean",description:"Flag indicating if the connection is selected (optional)"}},required:["sourceBlockId","targetBlockId"]},TAnchor:{type:"object",properties:{id:{type:"string",description:"Anchor identifier"},blockId:{type:"string",description:"Identifier of the block this anchor belongs to"},type:{type:"string",enum:["IN","OUT"],description:"Anchor type, either IN or OUT"},index:{type:"number",description:"Anchor index"}},required:["id","blockId","type"]}}}}]})}(e)});let T=(0,a.Ge)("editor"),A=c.forwardRef(function(e,t){let[n,o]=(0,c.useState)(),s=(0,c.useRef)(),a=(0,c.useRef)({blocks:[],connections:[]});(0,c.useImperativeHandle)(t,()=>({scrollTo:e=>{if(!s.current)return;let t=I(s.current.getModel(),e);t?.start.column&&s.current?.revealLinesInCenter(t.start.lineNumber,t.end.lineNumber,0),s.current.setSelection({startColumn:t.start.column,startLineNumber:t.start.lineNumber,endColumn:t.end.column,endLineNumber:t.end.lineNumber})},updateBlocks:e=>{let t=s.current?.getModel();if(!t)return;let n=e.map(e=>{let n=I(t,e.id),r=JSON.stringify({block:[e]},null,2);return{range:{startColumn:n.start.column,startLineNumber:n.start.lineNumber,endColumn:n.end.column,endLineNumber:n.end.lineNumber},text:r.slice(19,r.length-6)}});t.applyEdits(n)},setContent:e=>{let{blocks:t,connections:n}=e;a.current={blocks:t,connections:n},s.current&&s.current?.setValue(JSON.stringify(a.current,null,2))}}));let l=(0,c.useCallback)(()=>{let t=s.current?.getModel();if(t)try{let n=JSON.parse(t.getValue());e?.onChange?.({blocks:n.blocks,connections:n.conections})}catch(e){console.error(e)}},[s]);return(0,r.jsxs)(g.k,{direction:"column",className:T(),children:[(0,r.jsx)(g.k,{grow:1,children:(0,r.jsx)(B.ML,{onMount:e=>{s.current=e,s.current?.setValue(JSON.stringify(a.current,null,2)),e.addCommand(w.DC.CtrlCmd|w.VD.Enter,l)},onValidate:e=>{o(e.filter(e=>8===e.severity)[0]||null)},language:"json",theme:N,options:{contextmenu:!1,lineNumbersMinChars:4,glyphMargin:!1,fontSize:18,lineHeight:20,colorDecorators:!0,minimap:{enabled:!1},smoothScrolling:!0,"bracketPairColorization.editor":!0}})}),(0,r.jsxs)(g.k,{className:T("actions"),gap:3,children:[(0,r.jsxs)(i.z,{size:"l",disabled:!!n,view:"action",onClick:l,children:["Apply ",(0,r.jsx)(S.q,{className:T("hotkey"),view:"light",value:"mod+enter"})]}),(0,r.jsx)(i.z,{size:"l",disabled:!!n,onClick:e.addBlock,children:"Add Block"}),n&&(0,r.jsx)(g.k,{grow:1,alignItems:"center",justifyContent:"flex-end",children:(0,r.jsx)(m.x,{color:"danger",children:(0,r.jsx)("span",{style:{cursor:"pointer"},onClick:()=>{s.current?.revealLinesInCenter(n.startLineNumber,n.endLineNumber,0),s.current?.setSelection({startColumn:n.startColumn,startLineNumber:n.startLineNumber,endColumn:n.endColumn,endLineNumber:n.endLineNumber})},children:n.message})})})]})]})});n(20937);var L=n(852),z=n(56009);n(66641);let M=[{value:"bezier",content:"Bezier"},{value:"line",content:"Line"}],$=[{value:"bezier",content:"Show"},{value:"line",content:"Hide"}],E=(0,a.Ge)("graph-settings");function R(e){let{className:t,radionButtonClass:n,graph:o}=e,s=function(){let[e,t]=(0,c.useState)(Date.now());return(0,c.useCallback)(()=>{t(Date.now())},[])}(),[a,l]=c.useState(null),[d,h]=(0,c.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.z,{ref:l,size:"l",view:d?"action":"raised",className:t,onClick:()=>h(e=>!e),children:(0,r.jsx)(p.J,{data:L.Z})}),(0,r.jsx)(z.G,{anchorElement:a,open:d,onOpenChange:e=>{e||h(!1)},placement:["right-end"],children:(0,r.jsxs)(g.k,{direction:"column",className:E("popup"),gap:3,children:[(0,r.jsx)(m.x,{variant:"subheader-2",children:"Graph settings"}),(0,r.jsxs)(g.k,{direction:"column",gap:2,children:[(0,r.jsx)(m.x,{variant:"subheader-1",children:"Connection type"}),(0,r.jsx)(b.e,{className:n,size:"l",onUpdate:e=>{o.updateSettings({useBezierConnections:e===M[0].value}),s()},value:M[o.rootStore.settings.getConfigFlag("useBezierConnections")?0:1].value,options:M})]}),(0,r.jsxs)(g.k,{direction:"column",gap:2,children:[(0,r.jsx)(m.x,{variant:"subheader-1",children:"Show arrows"}),(0,r.jsx)(b.e,{size:"l",className:n,onUpdate:e=>{o.updateSettings({showConnectionArrows:e===$[0].value}),s()},value:$[o.rootStore.settings.getConfigFlag("showConnectionArrows")?0:1].value,options:$})]})]})})]})}var Z=n(20522);n(71640);let D=(0,a.Ge)("text-block");function F(e){let{graph:t,block:n}=e;return(0,r.jsx)(d.Je,{graph:t,block:n,className:D(),children:(0,r.jsxs)(g.k,{direction:"row",gap:2,alignItems:"center",grow:1,children:[(0,r.jsx)(p.J,{className:D("icon"),data:Z.Z,size:18}),(0,r.jsx)(m.x,{className:D("text"),ellipsis:!0,variant:"body-1",children:n.meta?.text})]})})}class H extends l.lR{renderHTML(){return(0,r.jsx)(F,{graph:this.context.graph,block:this.connectedState.$state.value})}renderMinimalisticBlock(e){this.renderBody(e)}renderSchematicView(e){this.renderBody(e),this.context.camera.getCameraScale()>this.context.constants.block.SCALES[0]&&this.renderName(e)}subscribe(e){return this.addEventListener("mouseenter",()=>{this.hovered=!0,this.performRender()}),this.addEventListener("mouseleave",()=>{this.hovered=!1,this.performRender()}),super.subscribe(e)}renderName(e){e.fillStyle="rgba(189, 142, 75, 1)",e.textAlign="center",this.renderText(this.state.meta?.text||"",e)}renderTextAtCenter(e,t){let n=this.getContentRect(),r=this.context.camera.getCameraScale();t.fillStyle="rgba(189, 142, 75, 1)",t.textAlign="center",t.textBaseline="bottom";let{lines:o,measures:i}=(0,l.If)(e,t,n,{font:`500 ${13/r}px YS Text`,lineHeight:9/r}),s=n.height/2-i.height/2;for(let e=0;e<o.length;e++){let[n,r,i]=o[e],c=Math.round(i+s);t.fillText(n,r,c)}}renderBody(e){let t=this.context.camera.getCameraScale();e.save(),e.lineWidth=Math.min(Math.round(2/t),12),e.fillStyle="rgba(189, 142, 75, 0.1)",e.beginPath(),e.roundRect(this.state.x,this.state.y,this.state.width,this.state.height,8),e.fill(),this.state.selected?e.lineWidth=Math.min(Math.round(2/t),12):(e.lineWidth=2,e.setLineDash([4,4])),e.strokeStyle="rgba(189, 142, 75, 1)",e.stroke(),e.closePath(),e.restore()}constructor(...e){super(...e),this.cursor="pointer",this.hovered=!1}}var J=n(65474),O=n(76949),V=n(42991),P=n(63193);function _(e){let{className:t,graph:n}=e,[o,s]=(0,c.useState)(1);return(0,d.sF)(n,"camera-change",e=>{let{scale:t}=e;s(t)}),(0,r.jsxs)(g.k,{grow:1,justifyContent:"center",className:t,direction:"column",children:[(0,r.jsx)(P.u,{content:"Zoom in",placement:"right",children:(0,r.jsx)(i.z,{size:"l",view:"raised",onClick:()=>{n.zoom({scale:n.cameraService.getCameraScale()+.08})},disabled:o>=n.cameraService.getCameraState().scaleMax,children:(0,r.jsx)(p.J,{data:J.Z})})}),(0,r.jsx)(P.u,{content:"Fit to viewport",placement:"right",children:(0,r.jsx)(i.z,{size:"l",view:"raised",onClick:()=>{n.zoomTo("center")},children:(0,r.jsx)(p.J,{data:O.Z})})}),(0,r.jsx)(P.u,{content:"Zoom out",placement:"right",children:(0,r.jsx)(i.z,{size:"l",view:"raised",onClick:()=>{n.zoom({scale:n.cameraService.getCameraScale()-.08})},disabled:o<=n.cameraService.getCameraState().scaleMin,children:(0,r.jsx)(p.J,{data:V.Z})})})]})}let G="block-action",U="block-text";function X(e){return`action_${e}`}function W(e,t,n){let r=X(n);return{is:G,id:r,x:e,y:t,width:126,height:126,selected:!1,name:`Block #${n}`,anchors:[{id:`${r}_in`,blockId:r,type:l.TX.IN},{id:`${r}_out`,blockId:r,type:l.TX.OUT}],meta:{description:"Description"}}}function q(e,t,n,r,o){return{is:U,id:`text_${r}`,x:e,y:t,width:n,height:48,selected:!1,name:"Text Block",anchors:[],meta:{text:o}}}function Y(e,t){return Math.round(Math.random()*(t-e)+e)}function Q(e,t){let n={blocks:[],connections:[]},r=[],o=0;for(let i=0;i<=e;i++){let s=i**2;i>=e/2&&(s=(e-i)**2);let c=(500-200*s)/2,a=500*i*2.5,l=[];for(let e=0;e<=s;e++){let t=W(a,c+200*e,++o);n.blocks.push(t),l.push(t)}if(i>1){for(let e=0;e<=t;e++){let e=Y(n.blocks.length-l.length-r.length-1,n.blocks.length-l.length-1),t=Y(n.blocks.length-l.length-1,n.blocks.length-1);if(e!==t){let r=X(e),o=X(t);n.connections.push({sourceBlockId:r,sourceAnchorId:`${r}_anchor_out`,targetBlockId:o,targetAnchorId:`${o}_anchor_in`})}}r=[...l]}}return n}let K=(0,a.Ge)("graph-playground"),ee=(0,a.Ge)("graph-playground-radio-buton"),et=Q(0,5),en=[q(-144,80,448,0,"To create new block, drag and drop new connection from edge"),q(-64,160,240,1,"Use scroll to zoom in or out")],er={viewConfiguration:{colors:{selection:{background:"rgba(255, 190, 92, 0.1)",border:"rgba(255, 190, 92, 1)"},connection:{background:"rgba(255, 255, 255, 0.5)",selectedBackground:"rgba(234, 201, 74, 1)"},block:{background:"rgba(37, 27, 37, 1)",border:"rgba(229, 229, 229, 0.2)",selectedBorder:"rgba(255, 190, 92, 1)",text:"rgba(255, 255, 255, 1)"},anchor:{background:"rgba(255, 190, 92, 1)"},canvas:{layerBackground:"rgba(22, 13, 27, 1)",belowLayerBackground:"rgba(22, 13, 27, 1)",dots:"rgba(255, 255, 255, 0.2)",border:"rgba(255, 255, 255, 0.3)"}},constants:{block:{SCALES:[.1,.2,.5]}}},settings:{canDragCamera:!0,canZoomCamera:!0,canDuplicateBlocks:!1,canChangeBlockGeometry:l.Q7.ALL,canCreateNewConnections:!0,showConnectionArrows:!1,scaleFontSize:1,useBezierConnections:!0,useBlocksAnchors:!0,showConnectionLabels:!1,blockComponents:{[G]:j,[U]:H}},layers:[[l.f1,{drawLine:(e,t)=>{let n=new Path2D;return n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),{path:n,style:{color:"rgba(234, 201, 74, 1)",dash:[5,5]}}}}]]},eo=[{value:"1",content:"1"},{value:"100",content:"100"},{value:"1000",content:"1 000"},{value:"10000",content:"10 000"}];function ei(e){let t=(0,c.useRef)(e);return t.current=e,(0,c.useCallback)(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.current(...n)},[])}let es=(0,c.memo)(e=>{let{className:t}=e,{graph:n,setEntities:o,updateEntities:s,start:a}=(0,d.n4)(er),k=(0,c.useRef)(null),[f,C]=(0,c.useState)(!0),y=ei(()=>{let e=n.rootStore.getAsConfig();k.current?.setContent({blocks:e.blocks||[],connections:e.connections||[]})});(0,d.sF)(n,"block-change",e=>{let{block:t}=e;k.current?.updateBlocks([t]),k.current?.scrollTo(t.id)}),(0,d.sF)(n,"blocks-selection-change",e=>{let{changes:t}=e;k.current?.updateBlocks([...t.add.map(e=>({...n.rootStore.blocksList.getBlock(e),selected:!0})),...t.removed.map(e=>({...n.rootStore.blocksList.getBlock(e),selected:!1}))])}),(0,d.sF)(n,"connection-created",(e,t)=>{let{sourceBlockId:r,sourceAnchorId:o,targetBlockId:i,targetAnchorId:s}=e;t.preventDefault(),o&&(n.rootStore.blocksList.getBlockState(r).getAnchorById(o).state.type===l.TX.IN?n.api.addConnection({sourceBlockId:i,sourceAnchorId:s,targetBlockId:r,targetAnchorId:o}):n.api.addConnection({sourceBlockId:r,sourceAnchorId:o,targetBlockId:i,targetAnchorId:s}),y())}),(0,d.sF)(n,"connection-create-drop",e=>{let t,{sourceBlockId:r,sourceAnchorId:o,targetBlockId:i,point:s}=e;i||(n.rootStore.blocksList.getBlockState(r).getAnchorById(o).state.type===l.TX.IN?(t=W(s.x-126,s.y-63,n.rootStore.blocksList.$blocksMap.value.size+1),n.api.addBlock(t),n.api.addConnection({sourceBlockId:t.id,sourceAnchorId:t.anchors[1].id,targetBlockId:r,targetAnchorId:o})):(t=W(s.x,s.y-63,n.rootStore.blocksList.$blocksMap.value.size+1),n.api.addBlock(t),n.api.addConnection({sourceBlockId:r,sourceAnchorId:o,targetBlockId:t.id,targetAnchorId:t.anchors[0].id})),n.zoomTo([t.id],{transition:250}),y(),k.current?.scrollTo(t.id))}),(0,c.useLayoutEffect)(()=>{o({blocks:[...en,...et.blocks],connections:et.connections}),y()},[o]),(0,d.sF)(n,"state-change",e=>{let{state:t}=e;t===l.VM.ATTACHED&&(a(),n.zoomTo("center",{padding:300}))});let v=ei(()=>{let e=n.rootStore.blocksList.getUsableRect(),t=W(x()(e.x,e.x+e.width+100),x()(e.y,e.y+e.height+100),n.rootStore.blocksList.$blocksMap.value.size+1);n.api.addBlock(t),n.zoomTo([t.id],{transition:250}),y(),k.current?.scrollTo(t.id)}),S=ei((e,t)=>{let n=e.rootStore.blocksList.getBlockState(t.id)?.getViewComponent();return n instanceof j||n instanceof H?n.renderHTML():(0,r.jsxs)(d.Je,{graph:e,block:t,children:["Unknown block ",(0,r.jsx)(r.Fragment,{children:t.id.toString()})]})});(0,d.sF)(n,"blocks-selection-change",e=>{let{list:t}=e;1===t.length&&k.current?.scrollTo(t[0])}),(0,c.useEffect)(()=>{let e=e=>{"Backspace"===e.code&&(n.api.deleteSelected(),y())};return document.body.addEventListener("keydown",e),()=>document.body.removeEventListener("keydown",e)});let B=async e=>{let t;switch(e){case eo[0].value:t=Q(0,5);break;case eo[1].value:t=Q(10,100);break;case eo[2].value:t=Q(23,150),C(!1);break;case eo[3].value:n.updateSettings({useBezierConnections:!1}),C(!1),t=Q(50,150)}t&&(await new Promise(e=>setTimeout(e,200)),o({blocks:t?.blocks,connections:t?.connections}),n.zoomTo("center",{transition:500}),y())};return(0,r.jsxs)(g.k,{className:K(null,t),gap:f?8:0,children:[(0,r.jsx)(i.z,{className:K("layout-button"),onClick:()=>C(!f),children:(0,r.jsx)(p.J,{data:f?h.Z:u.Z})}),(0,r.jsxs)(g.k,{direction:"column",grow:1,className:K("content",{graph:!0}),gap:6,children:[(0,r.jsxs)(g.k,{direction:"row",gap:4,alignItems:"center",children:[(0,r.jsx)(m.x,{variant:"header-1",className:K("title"),children:"Blocks"}),(0,r.jsx)(b.e,{className:ee(),options:eo,defaultValue:eo[0].value,onUpdate:B,size:"l"})]}),(0,r.jsxs)(g.k,{grow:1,className:K("view",{"graph-editor":!0}),children:[(0,r.jsxs)(g.k,{className:K("graph-tools"),direction:"column",children:[(0,r.jsx)(_,{graph:n,className:K("zoom","button-group")}),(0,r.jsx)(R,{className:K("graph-settings"),radionButtonClass:ee(),graph:n})]}),(0,r.jsx)(d.uR,{graph:n,renderBlock:S})]})]}),(0,r.jsxs)(g.k,{direction:"column",grow:1,className:K("content",{editor:!0,hidden:!f}),gap:6,children:[(0,r.jsx)(m.x,{variant:"header-1",className:K("title"),children:"JSON Editor"}),(0,r.jsx)(g.k,{grow:1,className:K("view",{"config-editor":!0}),children:(0,r.jsx)(A,{ref:k,onChange:e=>{let{blocks:t,connections:n}=e;s({blocks:t,connections:n})},addBlock:v})})]})]})}),ec=(0,a.Ge)("graph"),ea=(0,c.memo)(()=>{let{t:e,i18n:t}=(0,s.$G)("graph");return(0,r.jsxs)(o.rjZ,{className:ec(),containerClass:ec("container"),children:[(0,r.jsx)(o.X2j,{className:ec("title"),children:(0,r.jsxs)(o.JXS,{sizes:12,className:ec("heading"),children:[(0,r.jsx)("h1",{className:ec("title"),children:e("title")}),(0,r.jsx)("div",{className:ec("actions"),children:(0,r.jsx)(i.z,{href:(0,a.n6)("/libraries/graph",t),className:ec("library-button"),size:"xl",view:"outlined-contrast",children:e("goToLibrary")})})]})}),(0,r.jsx)(o.X2j,{className:ec("playground"),children:(0,r.jsx)(es,{className:ec("graph-viewer")},Date.now())})]})})},86540:function(){},27624:function(){},78407:function(){},20937:function(){},66641:function(){},71640:function(){}}]);